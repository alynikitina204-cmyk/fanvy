<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Users</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
.container { display:flex; }
.sidebar { width: 230px; background: var(--card); border-radius: var(--radius); padding:20px; box-shadow: var(--shadow-soft); }
.feed { flex:1; padding:30px; }
.table { width:100%; border-collapse: collapse; }
.table th, .table td { padding:10px; border-bottom:1px solid var(--soft-2); text-align:left; }
.table th { color: var(--muted); font-weight:600; }
.select { padding:6px 8px; border-radius:8px; border:1px solid var(--soft-3); background:var(--soft-1); color:var(--text); }
.save-btn { padding:6px 12px; border-radius:10px; border:none; background: var(--primary-gradient); color:#fff; cursor:pointer; }
.money-input { padding:4px 8px; border-radius:6px; border:1px solid var(--soft-3); width:80px; background:var(--soft-1); color:var(--text); }
.send-btn { padding:4px 10px; border-radius:8px; border:none; background:#10b981; color:#fff; cursor:pointer; font-size:12px; }
</style>
</head>
<body>
{% include '_theme_toggle.html' %}
<div class="container">
  <div class="sidebar">
    <h3>Hi {{ session.get('username','User') }}</h3>
    <a href="/forum">Community</a>
    <a href="/shop">Shop</a>
    <a href="/subscription">Subscription</a>
    <a href="/dashboard">Dashboard</a>
  </div>
  <div class="feed">
    <h2>Users</h2>
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Username</th>
          <th>Email</th>
          <th>Wallet</th>
          <th>Subscription</th>
          <th>Send Money</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.email }}</td>
          <td style="color:#10b981;font-weight:600;">${{ "%.2f"|format(u.wallet_balance or 0) }}</td>
          <td>
            <form method="POST" style="display:flex;gap:8px;align-items:center;">
              <input type="hidden" name="action" value="update_subscription">
              <input type="hidden" name="user_id" value="{{ u.id }}">
              <select name="subscription" class="select">
                <option value="none" {% if u.subscription=='none' %}selected{% endif %}>none</option>
                <option value="basic" {% if u.subscription=='basic' %}selected{% endif %}>basic</option>
                <option value="pro" {% if u.subscription=='pro' %}selected{% endif %}>pro</option>
                <option value="premium" {% if u.subscription=='premium' %}selected{% endif %}>premium</option>
              </select>
              <button class="save-btn" type="submit">Save</button>
            </form>
          </td>
          <td>
            <form method="POST" style="display:flex;gap:6px;align-items:center;">
              <input type="hidden" name="action" value="send_money">
              <input type="hidden" name="user_id" value="{{ u.id }}">
              <input type="number" name="amount" class="money-input" placeholder="$" step="0.01" min="0.01">
              <button class="send-btn" type="submit">
                <i class="fa-solid fa-paper-plane"></i> Send
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
</body>
</html>
